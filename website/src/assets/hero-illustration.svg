<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 550" fill="none">
  <defs>
    <!-- Gradients -->
    <linearGradient id="lineGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#10b981" stop-opacity="0.9"/>
      <stop offset="100%" stop-color="#6ee7b7" stop-opacity="0.6"/>
    </linearGradient>

    <linearGradient id="purpleGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#8b5cf6" stop-opacity="0.9"/>
      <stop offset="100%" stop-color="#c4b5fd" stop-opacity="0.6"/>
    </linearGradient>

    <!-- Glow effects -->
    <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>

    <filter id="strongGlow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="6" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>

    <!-- Card shadow -->
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="4" stdDeviation="10" flood-color="#000" flood-opacity="0.4"/>
    </filter>
  </defs>

  <!-- Background grid -->
  <pattern id="grid" width="50" height="50" patternUnits="userSpaceOnUse">
    <path d="M 50 0 L 0 0 0 50" fill="none" stroke="#1a1a1a" stroke-width="0.5"/>
  </pattern>
  <rect width="1200" height="550" fill="url(#grid)" opacity="0.6"/>

  <!-- ============ CONNECTION LINES ============ -->

  <!-- Agent to Requirements (purple) -->
  <path id="agentToReq1" d="M 200 220 C 280 170, 320 160, 380 155" stroke="url(#purpleGrad)" stroke-width="2.5" fill="none"/>
  <path id="agentToReq2" d="M 200 220 C 280 220, 320 220, 380 225" stroke="url(#purpleGrad)" stroke-width="2.5" fill="none"/>
  <path id="agentToReq3" d="M 200 220 C 280 270, 320 290, 380 295" stroke="url(#purpleGrad)" stroke-width="2.5" fill="none"/>

  <!-- Requirements to Tests (green) -->
  <path id="reqToTest1" d="M 520 155 Q 580 155, 620 195" stroke="url(#lineGrad)" stroke-width="2.5" fill="none"/>
  <path id="reqToTest2" d="M 520 225 Q 580 225, 620 225" stroke="url(#lineGrad)" stroke-width="2.5" fill="none"/>
  <path id="reqToTest3" d="M 520 295 Q 580 295, 620 255" stroke="url(#lineGrad)" stroke-width="2.5" fill="none"/>

  <!-- Tests to Status (green) -->
  <path id="testToStatus1" d="M 780 200 Q 840 160, 880 155" stroke="url(#lineGrad)" stroke-width="2.5" fill="none"/>
  <path id="testToStatus2" d="M 780 225 Q 840 225, 880 225" stroke="url(#lineGrad)" stroke-width="2.5" fill="none"/>
  <path id="testToStatus3" d="M 780 250 Q 840 290, 880 295" stroke="url(#lineGrad)" stroke-width="2.5" fill="none"/>

  <!-- Closed loop path (purple dashed) -->
  <path id="closedLoop" d="M 1020 225 C 1100 225, 1150 80, 600 30 C 150 -20, 50 100, 60 220"
        stroke="#8b5cf6" stroke-width="2.5" stroke-dasharray="10 5" fill="none" opacity="0.7">
    <animate attributeName="stroke-dashoffset" from="0" to="-30" dur="2s" repeatCount="indefinite"/>
  </path>

  <!-- ============ ANIMATED DOTS ON ALL PATHS ============ -->

  <!-- Purple dots: Agent to Requirements -->
  <circle r="5" fill="#8b5cf6" filter="url(#glow)">
    <animateMotion dur="1.8s" repeatCount="indefinite">
      <mpath href="#agentToReq1"/>
    </animateMotion>
  </circle>
  <circle r="5" fill="#8b5cf6" filter="url(#glow)">
    <animateMotion dur="2s" repeatCount="indefinite" begin="0.3s">
      <mpath href="#agentToReq2"/>
    </animateMotion>
  </circle>
  <circle r="5" fill="#8b5cf6" filter="url(#glow)">
    <animateMotion dur="2.2s" repeatCount="indefinite" begin="0.6s">
      <mpath href="#agentToReq3"/>
    </animateMotion>
  </circle>

  <!-- Green dots: Requirements to Tests -->
  <circle r="5" fill="#10b981" filter="url(#glow)">
    <animateMotion dur="1.5s" repeatCount="indefinite" begin="0.2s">
      <mpath href="#reqToTest1"/>
    </animateMotion>
  </circle>
  <circle r="5" fill="#10b981" filter="url(#glow)">
    <animateMotion dur="1.3s" repeatCount="indefinite" begin="0.5s">
      <mpath href="#reqToTest2"/>
    </animateMotion>
  </circle>
  <circle r="5" fill="#10b981" filter="url(#glow)">
    <animateMotion dur="1.7s" repeatCount="indefinite" begin="0.1s">
      <mpath href="#reqToTest3"/>
    </animateMotion>
  </circle>

  <!-- Green dots: Tests to Status -->
  <circle r="5" fill="#10b981" filter="url(#glow)">
    <animateMotion dur="1.4s" repeatCount="indefinite" begin="0.4s">
      <mpath href="#testToStatus1"/>
    </animateMotion>
  </circle>
  <circle r="5" fill="#10b981" filter="url(#glow)">
    <animateMotion dur="1.6s" repeatCount="indefinite" begin="0.7s">
      <mpath href="#testToStatus2"/>
    </animateMotion>
  </circle>
  <circle r="5" fill="#10b981" filter="url(#glow)">
    <animateMotion dur="1.5s" repeatCount="indefinite" begin="0.2s">
      <mpath href="#testToStatus3"/>
    </animateMotion>
  </circle>

  <!-- Purple dot: Closed loop verification -->
  <circle r="6" fill="#8b5cf6" filter="url(#strongGlow)">
    <animateMotion dur="5s" repeatCount="indefinite">
      <mpath href="#closedLoop"/>
    </animateMotion>
  </circle>
  <circle r="6" fill="#c4b5fd" filter="url(#strongGlow)">
    <animateMotion dur="5s" repeatCount="indefinite" begin="2.5s">
      <mpath href="#closedLoop"/>
    </animateMotion>
  </circle>

  <!-- ============ AGENT (left) ============ -->
  <g filter="url(#shadow)">
    <rect x="60" y="150" width="140" height="140" rx="12" fill="#171717" stroke="#8b5cf6" stroke-width="2"/>
    <circle cx="130" cy="195" r="28" fill="#1e1e1e" stroke="#8b5cf6" stroke-width="2"/>
    <text x="130" y="203" fill="#c4b5fd" font-size="22" text-anchor="middle" font-family="system-ui" font-weight="600">AI</text>
    <text x="130" y="245" fill="#e5e7eb" font-size="13" text-anchor="middle" font-family="system-ui" font-weight="600">Claude / MCP</text>
    <text x="130" y="268" fill="#6b7280" font-size="10" text-anchor="middle" font-family="monospace">Creates specs</text>
    <text x="130" y="282" fill="#6b7280" font-size="10" text-anchor="middle" font-family="monospace">Queries status</text>
  </g>

  <!-- ============ REQUIREMENTS ============ -->
  <g filter="url(#shadow)">
    <rect x="380" y="115" width="140" height="55" rx="6" fill="#171717" stroke="#262626"/>
    <text x="450" y="138" fill="#9ca3af" font-size="11" text-anchor="middle" font-family="monospace">REQ-AUTH-001</text>
    <text x="450" y="158" fill="#10b981" font-size="10" text-anchor="middle" font-family="system-ui">OAuth Login</text>
  </g>

  <g filter="url(#shadow)">
    <rect x="380" y="185" width="140" height="55" rx="6" fill="#171717" stroke="#262626"/>
    <text x="450" y="208" fill="#9ca3af" font-size="11" text-anchor="middle" font-family="monospace">REQ-API-001</text>
    <text x="450" y="228" fill="#10b981" font-size="10" text-anchor="middle" font-family="system-ui">REST API</text>
  </g>

  <g filter="url(#shadow)">
    <rect x="380" y="255" width="140" height="55" rx="6" fill="#171717" stroke="#262626"/>
    <text x="450" y="278" fill="#9ca3af" font-size="11" text-anchor="middle" font-family="monospace">REQ-DATA-001</text>
    <text x="450" y="298" fill="#10b981" font-size="10" text-anchor="middle" font-family="system-ui">Database</text>
  </g>

  <!-- ============ TESTS ============ -->
  <g filter="url(#shadow)">
    <rect x="620" y="150" width="160" height="150" rx="10" fill="#171717" stroke="#10b981" stroke-width="2"/>
    <text x="700" y="180" fill="#e5e7eb" font-size="14" text-anchor="middle" font-family="system-ui" font-weight="600">pytest</text>
    <text x="700" y="202" fill="#6b7280" font-size="10" text-anchor="middle" font-family="monospace">@pytest.mark.req</text>
    <rect x="640" y="215" width="120" height="22" rx="4" fill="#1e1e1e"/>
    <text x="700" y="231" fill="#22c55e" font-size="11" text-anchor="middle" font-family="monospace">✓ 12 passed</text>
    <rect x="640" y="242" width="120" height="22" rx="4" fill="#1e1e1e"/>
    <text x="700" y="258" fill="#f59e0b" font-size="11" text-anchor="middle" font-family="monospace">△ 2 partial</text>
    <rect x="640" y="269" width="120" height="22" rx="4" fill="#1e1e1e"/>
    <text x="700" y="285" fill="#ef4444" font-size="11" text-anchor="middle" font-family="monospace">✗ 4 missing</text>
  </g>

  <!-- ============ STATUS ============ -->
  <g filter="url(#shadow)">
    <rect x="880" y="105" width="180" height="240" rx="10" fill="#171717" stroke="#262626"/>
    <rect x="880" y="105" width="180" height="28" rx="10" fill="#2d2d2d"/>
    <circle cx="898" cy="119" r="5" fill="#ff5f56"/>
    <circle cx="914" cy="119" r="5" fill="#ffbd2e"/>
    <circle cx="930" cy="119" r="5" fill="#27ca40"/>
    <text x="980" y="123" fill="#6b7280" font-size="9" text-anchor="middle" font-family="system-ui">rtmx status</text>
    <text x="900" y="158" fill="#9ca3af" font-size="10" font-family="monospace">Requirements:</text>
    <rect x="900" y="166" width="140" height="14" rx="2" fill="#262626"/>
    <rect x="900" y="166" width="77" height="14" rx="2" fill="#22c55e"/>
    <rect x="977" y="166" width="22" height="14" fill="#f59e0b"/>
    <rect x="999" y="166" width="41" height="14" rx="2" fill="#ef4444"/>
    <text x="1050" y="177" fill="#9ca3af" font-size="10" font-family="monospace">54%</text>
    <text x="910" y="210" fill="#22c55e" font-size="11" font-family="monospace">✓ 5 complete</text>
    <text x="910" y="230" fill="#f59e0b" font-size="11" font-family="monospace">△ 3 partial</text>
    <text x="910" y="250" fill="#ef4444" font-size="11" font-family="monospace">✗ 4 missing</text>
    <text x="910" y="275" fill="#6b7280" font-size="10" font-family="monospace">(12 total)</text>
    <text x="910" y="305" fill="#9ca3af" font-size="9" font-family="monospace">Phase 1: 91.7% ▲</text>
    <text x="910" y="320" fill="#9ca3af" font-size="9" font-family="monospace">Phase 2: 25.0% ▲</text>
    <text x="910" y="335" fill="#6b7280" font-size="9" font-family="monospace">Phase 3: 0.0% ○</text>
  </g>

  <!-- ============ COLUMN LABELS ============ -->
  <text x="130" y="120" fill="#8b5cf6" font-size="13" text-anchor="middle" font-family="system-ui" font-weight="600">Agent</text>
  <text x="450" y="90" fill="#6b7280" font-size="13" text-anchor="middle" font-family="system-ui" font-weight="600">Requirements</text>
  <text x="700" y="130" fill="#10b981" font-size="13" text-anchor="middle" font-family="system-ui" font-weight="600">Tests</text>
  <text x="970" y="85" fill="#6b7280" font-size="13" text-anchor="middle" font-family="system-ui" font-weight="600">Status</text>

  <!-- ============ FOOTER: WORKFLOW LEGEND ============ -->
  <rect x="0" y="420" width="1200" height="130" fill="#0d0d0d"/>
  <line x1="0" y1="420" x2="1200" y2="420" stroke="#262626" stroke-width="1"/>

  <!-- Main tagline -->
  <text x="600" y="460" fill="#f9fafb" font-size="22" text-anchor="middle" font-family="system-ui" font-weight="700">
    Distributed Closed-Loop Verification
  </text>

  <!-- Workflow steps -->
  <g transform="translate(100, 490)">
    <!-- Step 1 -->
    <circle cx="0" cy="12" r="16" fill="#8b5cf6" opacity="0.2"/>
    <text x="0" y="17" fill="#8b5cf6" font-size="14" text-anchor="middle" font-family="system-ui" font-weight="700">1</text>
    <text x="40" y="10" fill="#c4b5fd" font-size="11" font-family="system-ui" font-weight="600">WRITE</text>
    <text x="40" y="26" fill="#6b7280" font-size="10" font-family="system-ui">Agent creates specs</text>
  </g>

  <g transform="translate(320, 490)">
    <!-- Step 2 -->
    <circle cx="0" cy="12" r="16" fill="#10b981" opacity="0.2"/>
    <text x="0" y="17" fill="#10b981" font-size="14" text-anchor="middle" font-family="system-ui" font-weight="700">2</text>
    <text x="40" y="10" fill="#6ee7b7" font-size="11" font-family="system-ui" font-weight="600">LINK</text>
    <text x="40" y="26" fill="#6b7280" font-size="10" font-family="system-ui">Tests trace to requirements</text>
  </g>

  <g transform="translate(560, 490)">
    <!-- Step 3 -->
    <circle cx="0" cy="12" r="16" fill="#10b981" opacity="0.2"/>
    <text x="0" y="17" fill="#10b981" font-size="14" text-anchor="middle" font-family="system-ui" font-weight="700">3</text>
    <text x="40" y="10" fill="#6ee7b7" font-size="11" font-family="system-ui" font-weight="600">REPORT</text>
    <text x="40" y="26" fill="#6b7280" font-size="10" font-family="system-ui">Status updates in real-time</text>
  </g>

  <g transform="translate(800, 490)">
    <!-- Step 4 -->
    <circle cx="0" cy="12" r="16" fill="#8b5cf6" opacity="0.2"/>
    <text x="0" y="17" fill="#8b5cf6" font-size="14" text-anchor="middle" font-family="system-ui" font-weight="700">4</text>
    <text x="40" y="10" fill="#c4b5fd" font-size="11" font-family="system-ui" font-weight="600">VERIFY</text>
    <text x="40" y="26" fill="#6b7280" font-size="10" font-family="system-ui">Agent queries via MCP</text>
  </g>

  <!-- Loop indicator -->
  <g transform="translate(1020, 490)">
    <path d="M 0 12 C 30 -10, 60 -10, 60 12 C 60 34, 30 34, 0 12" stroke="#8b5cf6" stroke-width="2" fill="none" stroke-dasharray="4 2">
      <animate attributeName="stroke-dashoffset" from="0" to="-12" dur="1s" repeatCount="indefinite"/>
    </path>
    <text x="30" y="17" fill="#8b5cf6" font-size="9" text-anchor="middle" font-family="system-ui" font-weight="600">LOOP</text>
  </g>
</svg>
